<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Buszmenetrend</title>
  <style>
    table { border-collapse: collapse; font-family: sans-serif; }
    th { background-color: lightblue; }
    th, td { border: 1px solid #ccc; padding: 6px 10px; text-align: center; }
    th:first-child, td:first-child { text-align: left; font-weight: bold; }
    button { cursor: pointer; margin: 2px; }
    h1 { text-align: center; }
    div { text-align: right; }
    div>h3 { margin-right: 221px;}
  </style>
</head>
<body>

<h1>A busz (egy√°ltal√°n nem a 70-es)</h1>


<table id="menetrend"></table>
<div>
<h3>√öj meg√°ll√≥ hozz√°ad√°sa</h3>
<input id="ujNev" placeholder="Meg√°ll√≥ neve">
<input id="ujPerc" type="number" placeholder="+ perc">
<button id="hozzaad">Hozz√°ad</button>
</div>
<script>

const jarat70 = {
  megallok: [
    {nev: "Szeged, Mars t√©r (Szent R√≥kus t√©r)", pluszPerc: 0},
    {nev: "Mars t√©r (aut. √°ll.)", pluszPerc: 1},
    {nev: "Bart√≥k t√©r", pluszPerc: 2},
    {nev: "Sz√©chenyi t√©r", pluszPerc: 4},
    {nev: "Szeged, Toront√°l t√©r", pluszPerc: 7},
    {nev: "√öjszeged, Gabonakutat√≥", pluszPerc: 8},
    {nev: "Als√≥ kik√∂t≈ë sor", pluszPerc: 10},
    {nev: "Hath√°zak", pluszPerc: 11},
    {nev: "Szeged, Ak√°cfa utca", pluszPerc: 12},
    {nev: "F√ºv√©szkert", pluszPerc: 13}
  ],
  indulasiIdok: [
    "6:45", "7:15", "7:45", "8:45", "9:45",
    "10:45", "11:45", "12:45", "13:15", "13:45",
    "14:15", "14:45", "15:15", "15:45", "16:15",
    "16:45", "17:15", "17:45", "18:15", "18:45",
    "19:15", "19:45", "20:45", "21:45", "22:45"
  ]
};

// kisz√°molja a meg√°ll√≥hoz tartoz√≥ √©rkez√©si id≈ët
function idoHozzaadas(alapIdo, pluszPerc) {
  const [ora, perc] = alapIdo.split(":").map(Number);
  const d = new Date();
  d.setHours(ora, perc + pluszPerc, 0);
  return d.toTimeString().slice(0, 5); // HH:MM form√°tum
}

// t√°bl√°zat l√©trehoz√°sa √©s friss√≠t√©se
function tablaRajzolas() {
  const tabla = document.getElementById("menetrend");
  tabla.innerHTML = ""; // el≈ëz≈ë tartalom t√∂rl√©se

  // fejl√©c
  const thead = document.createElement("thead");
  let fejlec = "<tr><th>Meg√°ll√≥</th>";
  jarat70.indulasiIdok.forEach(i => { fejlec += `<th>${i}</th>`; });
  fejlec += "<th>M≈±velet</th></tr>"; // utols√≥ oszlop gomboknak
  thead.innerHTML = fejlec;
  tabla.appendChild(thead);

  // t√∂rzs l√©trehoz√°sa
  const tbody = document.createElement("tbody");

  jarat70.megallok.forEach((m, index) => {
    const tr = document.createElement("tr");

    let sor = `<td>${m.nev}</td>`; // meg√°ll√≥ neve
    jarat70.indulasiIdok.forEach(ido => {
      sor += `<td>${idoHozzaadas(ido, m.pluszPerc)}</td>`; // minden id≈ë kisz√°m√≠t√°sa
    });

    // gombok: m√≥dos√≠t√°s ‚úèÔ∏è √©s t√∂rl√©s üóëÔ∏è
    sor += `
      <td>
        <button class="modosit" data-index="${index}">‚úèÔ∏è</button>
        <button class="torol" data-index="${index}">üóëÔ∏è</button>
      </td>
    `;

    tr.innerHTML = sor;
    tbody.appendChild(tr);
  });

  tabla.appendChild(tbody);

  // m√≥dos√≠t√°s gomb esem√©ny
  tabla.querySelectorAll(".modosit").forEach(btn => {
    btn.addEventListener("click", () => {
      const i = Number(btn.dataset.index);
      const aktualis = jarat70.megallok[i].pluszPerc;
      const uj = prompt(`√öj +perc √©rt√©k (${aktualis}):`, aktualis);
      if (uj === null) return; // cancel eset√©n kil√©p
      const ujPerc = Number(uj);
      if (isNaN(ujPerc)) { alert("Sz√°mot adj meg!"); return; }
      jarat70.megallok[i].pluszPerc = ujPerc;
      jarat70.megallok.sort((a,b) => a.pluszPerc - b.pluszPerc); // sorrend friss√≠t√©se
      tablaRajzolas(); // √∫jrarajzol√°s
    });
  });

  // t√∂rl√©s gomb esem√©ny
  tabla.querySelectorAll(".torol").forEach(btn => {
    btn.addEventListener("click", () => {
      const i = Number(btn.dataset.index);
      if (!confirm("Biztosan t√∂rl√∂d ezt a meg√°ll√≥t?")) return;
      jarat70.megallok.splice(i, 1); // sor t√∂rl√©se
      tablaRajzolas(); // √∫jrarajzol√°s
    });
  });
}

// √∫j meg√°ll√≥ hozz√°ad√°sa sorrendbe
document.getElementById("hozzaad").addEventListener("click", () => {
  const nev = document.getElementById("ujNev").value.trim();
  const perc = Number(document.getElementById("ujPerc").value);

  if (!nev) { alert("Add meg a meg√°ll√≥ nev√©t!"); return; }

  const ujMegallo = { nev: nev, pluszPerc: isNaN(perc) ? 0 : perc };

  // sorrendbe illeszt√©s pluszPerc szerint
  const index = jarat70.megallok.findIndex(m => m.pluszPerc > ujMegallo.pluszPerc);
  if (index === -1) jarat70.megallok.push(ujMegallo); // v√©g√©re
  else jarat70.megallok.splice(index, 0, ujMegallo); // k√∂z√©pre

  document.getElementById("ujNev").value = "";
  document.getElementById("ujPerc").value = "";

  tablaRajzolas(); // t√°bl√°zat friss√≠t√©se
});

// oldal bet√∂lt√©sekor t√°bl√°zat megjelen√≠t√©se
tablaRajzolas();
</script>

</body>
</html>